![微信图片_20191204201420](../images/微信图片_20191204201420.png)

# 前言

​        最近，项目中需要将用户选择的时间转换成`cron`表达式，传给后端。由于之前没有接触过`cron`表达式，所以，我准备花点时间来学习一下，并且记录下来。那么，什么是`cron`表达式呢？其实，一个`cron`表达式代表的是一组时间信息，记录的是每隔多久时间来执行一次任务，常见于主机上的操作。

# 详解cron表达式组成

​    `cron`表达式是一个字符串，主要由6~7位字符互相间隔空格所组成。从左到右分别为：秒（`Seconds `）、分(`Minutes `)、时(`Hours `)、日期(`DayofMonth `)、月份(`Month `)、星期(`DayofWeek `)、年（`Year`可留空）。每一个字符均可使用`，-*/`四个特殊字符。`DayofMonth `还可以使用`? L W C`，`DayofWeek `还可以使用`? L C #`。那么总共九个不同的字符都分别代表什么呢？(注意，这些字符都是英文输入法下的字符)

| 特殊字符 | 含义                                                         |
| -------- | :----------------------------------------------------------- |
| *        | 表示匹配该域的任何值，最小单位为1。比如在`Minutes`中使用，就代表每分钟都会触发事件。 |
| ?        | 有限制的使用范围，只能在`DayofMonth`以及`DayofWeek`中使用。在两个时间段相冲突的时候使用。比如，每周二 20:00触发，那么我们的表达式可写成`0 0 20 ? * 3`。那我们想一想，假如写成` 0 0 20 * * 3`会怎样？**由于`DayofMonth`的值代表是每天，而`DayofWeek`的值是代表每周二，他们其实是同一级别上的单位，那么对于解析表达式的机器来说，它就无法确定这个事件该什么时候触发了**。所以由此我们可以得出结论`DayofMonth`以及`DayofWeek`的值必有一个为`?`。 |
| -        | 表示范围。例如在`Minutes`中使用10-40，表示从10分到40分中每分钟触发一次事件。 |
| /        | 表示间隔时间。例如`Minutes`中使用10/10，表示每10分中触发一次，在10,20,30,40等分别触发一次。配合-可指定触发的范围。默认为0-59分的范围内触发。 |
| ,        | 表示列出枚举值。例如`Minutes`中使用10,20，那么以为这10分和20分将会触发事件。 |
| L        | 表示最后，只能出现在`DayofWeek`和`DayofMonth`域中。如果`DayofWeek`使用5L，意味着在最后一个星期四触发。 |
| W        | 表示有效工作日（周一到周五）。只能出现在`DayofMonth`域，系统将在离指定日期的最近的有效工作日触发事件。例如：在 `DayofMonth`使用5W，如果5日是星期六，则将在最近的工作日：星期五，即4日触发。如果5日是星期天，则在6日(周一)触发；如果5日在星期一到星期五中的一天，则就在5日触发。另外一点，W的最近寻找不会跨过月份 |
|          | 该字符只在`DayofWeek`和`DayofMonth`中使用，代表“Calendar”的意思。它的意思是计划所关联的日期，如果日期没有被关联，则相当于日历中所有日期。例如 5C 在日期字段中就相当于日历 5 日以后的第一天。1C 在星期字段中相当于星期日后的第一天。 |
| #        | 用于确定每个月第几个星期几，只能出现在`DayofWeek`域。例如在4#2，表示某月的第二个星期三。 |

其次每一位上的值都有不同的取值范围，尤其是星期的取值需要额外注意：

| 字段                 | 允许值                                            |
| -------------------- | ------------------------------------------------- |
| 秒 (`Seconds`)       | 0~59的整数                                        |
| 分（`Minutes `）     | 0~59的整数                                        |
| 小时（`Hours `）     | 0~23的整数                                        |
| 日期 (`DayofMonth `) | 1~31的整数（但是你需要考虑你月的天数）            |
| 月份 (`Month `)      | 1~12的整数或者 JAN-DEC                            |
| 星期 (`DayofWeek `)  | 1~7的整数或者 SUN-SAT （尤其注意！！！**1=SUN**） |
| 年（`Year`可留空）   | 1970~2099                                         |

# 一些cron表达式的互相转换解读





![liule](../images/liule.png)

------

# 参考资料

- [`cron`表达式的详细用法](https://www.jianshu.com/p/e9ce1a7e1ed1)
- [`JavaScript` 日期格式与`cron`表达式的互相转换](https://blog.csdn.net/wh13267207590/article/details/79667529)
- [cron表达式在线校验工具以及cron表达式详解](http://www.bejson.com/othertools/cronvalidate/)